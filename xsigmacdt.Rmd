---
title: "X & Sigma condition"
author: "Fabien Petit"
date: "11/06/2019"
output: 
  github_document:	
    pandoc_args: --webtex
---

```{r Init, include = FALSE}	

# Define required packages
require(dplyr) # The FAMOUS one
require(reshape2) # Reshape data frame
require(ggplot2) # Plot

# Define paths
loc_final = file.path("data", "final")

# Define country set
# country_set = c("Australia", "Canada", "France", "Italy", "Japan", "United States")
country_set = c("France", "United States")

```	

In the model, I obtain a condition on the capital-labor elasticity of substitution $\sigma$ and the unemployment replacement rate which ensures a positive capital-to-labor ratio and therefore a positive wage. This condition is the following :
$$
\frac{1}{\sigma} > X_t \equiv \ln\left[\frac{(1-\tau_t)w_t}{b_t}\right]
$$
where $X_t$ is the value-added to have a job in utility terms, $w_t$ is the wage rate, $tau_t$ the tax rate and $b_t$ the unemployment benefits per capita. Thus, it is possible to rewrite this condition such that :
$$
e^{-\frac{1}{\sigma}} < \frac{b_t}{(1-\tau_t)w_t}
$$
The right hand side of this inequality corresponds to the unemployment replacement rate. Hence, I check whether this constraint is feasible for OECD countries and particulary those considered in the simulation (i.e. France and United States).

Let plot the function $f(\sigma) = e^{-\frac{1}{\sigma}}$ for likely values of $\sigma$, so an interval between 0 and 3 :

```{r f Plot, echo = FALSE}

# Define function
sigma = function(urep){
  F1 = - log(urep)^(-1)
  return(F1)
}

# Interval between 0 and 3 for feasible values of urep
interval = seq(0.01, 0.8, by = 0.001)

# Compute sigma values
xsigma = data.frame("Function", interval, sigma(interval)) %>% 
  setNames(c("Country", "interval", "sigma_values"))

## Add latex
xsigma %>% 
  ggplot(aes(x = interval, y = sigma_values)) +
  geom_line(size = 1) +
  theme_classic(base_size = 14) +
  labs(x = "Unemployment Replacement Rate", y = "Max Capital-labor elasticity of substitution")

```

```{r f Plot and Country - Computation, echo = FALSE}
# Load CWED data
cwed = read.csv(file.path(loc_final, "cwed.csv"), header = TRUE)

# Average, min and first value of Unemployment Replacement Rate
cwed = cwed %>% 
  group_by(Country) %>% 
  summarise(US100_min = min(US100.lin_inter, na.rm = TRUE),
         UC1000_min = min(UC1000.lin_inter, na.rm = TRUE),
         US100_mean = mean(US100.lin_inter, na.rm = TRUE),
         UC1000_mean = mean(UC1000.lin_inter, na.rm = TRUE),
         US100_first = first(na.omit(US100.lin_inter)),
         UC1000_first = first(na.omit(UC1000.lin_inter)))

# Visualization
cwed

```


```{r f Plot and Country, echo = FALSE}

# Country set
country_set = c("France", "United States")

# Select Min for France and US
min_x = cwed %>% 
  subset(Country %in% country_set) %>% 
  select(Country, US100_min) %>% 
  setNames(c("Country", "interval")) %>% 
  mutate(sigma_values = -log(interval)^(-1))

### Plot

## Add latex
xsigma %>% 
  ggplot(aes(x = interval, y = sigma_values)) +
  geom_line(size = 1) +
  geom_segment(aes(x = 0,
                   xend = min_x %>% 
                     subset(Country == "France") %>% pull("interval"),
                   y = min_x %>% 
                     subset(Country == "France") %>% pull("sigma_values"),
                   yend = min_x %>% 
                     subset(Country == "France") %>% pull("sigma_values")),
               col = "red", linetype = "dashed") +
  geom_segment(aes(x = 0,
                   xend = min_x %>% 
                     subset(Country == "United States") %>% pull("interval"),
                   y = min_x %>% 
                     subset(Country == "United States") %>% pull("sigma_values"),
                   yend = min_x %>% 
                     subset(Country == "United States") %>% pull("sigma_values")),
               col = "blue", linetype = "dashed") +
  geom_segment(aes(x = min_x %>% 
                     subset(Country == "France") %>% pull("interval"),
                   xend = min_x %>% 
                     subset(Country == "France") %>% pull("interval"),
                   y = 0,
                   yend = min_x %>% 
                     subset(Country == "France") %>% pull("sigma_values")),
               col = "red", linetype = "dashed") +
  geom_segment(aes(x = min_x %>% 
                     subset(Country == "United States") %>% pull("interval"),
                   xend = min_x %>% 
                     subset(Country == "United States") %>% pull("interval"),
                   y = 0,
                   yend = min_x %>% 
                     subset(Country == "United States") %>% pull("sigma_values")),
               col = "blue", linetype = "dashed") +
  theme_classic(base_size = 14) +
  labs(x = "Unemployment Replacement Rate", y = "Max Capital-labor elasticity of substitution")

```













