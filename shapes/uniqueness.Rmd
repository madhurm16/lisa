---
title: "Equilibrium Uniqueness"
author: "Fabien Petit"
date: "17/06/2019"
output: 
  github_document:	
    pandoc_args: --webtex
---

```{r Initialization, include = FALSE}

# Load packages
packages <- c("dplyr", "ggplot2", "ggrepel", "RColorBrewer", "reshape2", "extrafont", "latex2exp")
lapply(packages, require, character.only = TRUE)
rm(packages)

# Graphic parameter
scale_graph = 1920/1080
red = brewer.pal(8, "Set1")[1]

```

## g function

The g function has four different shapes according to the value of $\sigma$ and both vertical asymptotes ($k_1$ and $k_2$). The function graphs are drawn using numerical computation with the following set of parameters for each case: a) $\sigma = 0.8$, $k_1 = 1$, $k_2 = 2$ ; b) $\sigma = 0.8$, $k_1 = 2$, $k_2 = 1$ ; c) $\sigma = 1.2$, $k_1 = 1$, $k_2 = 2$ ; d) $\sigma = 1.2$, $k_1 = 2$, $k_2 = 1$.

```{r g function - Define, include = FALSE}

g = function(k, sigma, k1, k2){
  G = log((k/k1-1)/((k/k2)^((sigma-1)/sigma)-1))
  return(G)
}

```

```{r g function - Generate, include = FALSE, warning = FALSE}

# Interval dataframe
df = data.frame("inter" = seq(0, 10, length.out = 10000))

# 4 cases
param = list(sigma = c(0.8, 0.8, 1.2, 1.2),
             k1 = c(1, 2, 1, 2),
             k2 = c(2, 1, 2, 1))

df = df %>% 
  mutate(g1 = g(inter, param$sigma[1], param$k1[1], param$k2[1]),
         g2 = g(inter, param$sigma[2], param$k1[2], param$k2[2]),
         g3 = g(inter, param$sigma[3], param$k1[3], param$k2[3]),
         g4 = g(inter, param$sigma[4], param$k1[4], param$k2[4]),) %>% 
  melt(id.vars = "inter")

```

### Case a)

```{r g Function - Graph a, echo = FALSE, warning = FALSE}

df %>%
  subset(variable == "g1") %>% 
  
  ggplot(aes(x = inter, y = value)) +
  geom_line(color = red) +
  # Dashed lines (specific values)
  geom_vline(xintercept = 1, color = red, linetype = "longdash", alpha = 0.5) +
  geom_vline(xintercept = 2, color = red, linetype = "longdash", alpha = 0.5) +
  # Axis
  scale_x_continuous(name = "", breaks = c(1, 2),
                     labels = c(TeX('$k_1$'),TeX('$k_2$')),
                     limits = c(0,3),
                     expand = c(0,0)) + 
  scale_y_continuous(name = "", breaks = c(0, 3.7),
                     labels = c(TeX('$0$'), TeX('$X_t$')),
                      limits = c(-1.5,3.5)) +
  # Graphic background
  coord_cartesian() + 
  theme_classic(base_size = 20) +
  theme(axis.line.x = element_blank(),
         axis.line = element_line(arrow = arrow(angle = 30, length = unit(0.4, "cm"), type = "open")),
         axis.ticks.x = element_blank(),
         axis.ticks.y = element_blank(),
         axis.text.x = element_text(color = red),
         axis.text.y = element_text(color = "black")) +
  annotate("segment", x = 0, xend = 2.97, y = 0, yend = 0,
           arrow = arrow(angle = 30, length = unit(0.4, "cm"), type = "open"), size = 1) +
  # Annotations
  annotate("text", x = 2.94, y = -0.2, label = TeX('$k_t$'), size = 6) +
  annotate("text", x = 1.5, y = 2.5, label = TeX('$g(k_t)$'), size = 5, col = "red") +
  # Save
  ggsave("graph_a.png", width = 7, height = 7)




```

### Case b)

```{r g Function - Graph b, echo = FALSE, warning = FALSE}

df %>%
  subset(variable == "g2") %>% 
  
  ggplot(aes(x = inter, y = value)) +
  geom_line(color = red) +
  # Dashed lines (specific values)
  geom_vline(xintercept = 1, color = red, linetype = "longdash", alpha = 0.5) +
  geom_vline(xintercept = 2, color = red, linetype = "longdash", alpha = 0.5) +
  # Axis
  scale_x_continuous(name = "", breaks = c(1,2), 
                     labels=c(TeX('$k_2$'),TeX('$k_1$')),
                     limits=c(0,3), expand = c(0,0)) +
  scale_y_continuous(name = "", breaks = c(0, 3.7),
                     labels = c(TeX('$0$'), TeX('$X_t$')),
                     limits = c(-1.5,3.5)) +
  # Graphic background
  coord_cartesian() + 
  theme_classic(base_size = 20) +
  theme(axis.line.x = element_blank(),
         axis.line = element_line(arrow = arrow(angle = 30, length = unit(0.4, "cm"), type = "open")),
         axis.ticks.x = element_blank(),
         axis.ticks.y = element_blank(),
         axis.text.x = element_text(color = red),
         axis.text.y = element_text(color = "black")) +
  annotate("segment", x = 0, xend = 2.97, y = 0, yend = 0,
           arrow = arrow(angle = 30, length = unit(0.4, "cm"), type = "open"), size = 1) +
  # Annotations
  annotate("text", x = 2.94, y = -0.2, label = TeX('$k_t$'), size = 6) +
  annotate("text", x = 1.5, y = 1.5, label = TeX('$g(k_t)$'), size = 5, col = "red") +
  # Save
  ggsave("graph_b.png", width = 7, height = 7)

```

```{r g Function - Graph c, echo = FALSE, warning = FALSE}

df %>%
  subset(variable == "g3") %>% 
  
  ggplot(aes(x = inter, y = value)) +
  geom_line(color = red) +
  # Dashed lines (specific values)
  geom_vline(xintercept = 1, color = red, linetype = "longdash", alpha = 0.5) +
  geom_vline(xintercept = 2, color = red, linetype = "longdash", alpha = 0.5) +
  # Axis
  scale_x_continuous(name = "", breaks = c(1,2),
                     labels = c(TeX('$k_1$'),TeX('$k_2$')),
                     limits = c(0, 10), expand = c(0,0)) +
  scale_y_continuous(name = "", breaks = c(0, 7.4),
                     labels = c(TeX('$0$'), TeX('$X_t$')),
                     limits = c(-3, 7)) +
  # Graphic background
  coord_cartesian() + 
  theme_classic(base_size = 20) +
  theme(axis.line.x = element_blank(),
         axis.line = element_line(arrow = arrow(angle = 30, length = unit(0.4, "cm"), type = "open")),
         axis.ticks.x = element_blank(),
         axis.ticks.y = element_blank(),
         axis.text.x = element_text(color = red),
         axis.text.y = element_text(color = "black")) +
  annotate("segment", x = 0, xend = 9.9, y = 0, yend = 0,
           arrow = arrow(angle = 30, length = unit(0.4, "cm"), type = "open"), size = 1) +
  # Annotations
  annotate("text", x = 9.8, y = -0.4, label = TeX('$k_t$'), size = 6) +
  annotate("text", x = 4, y = 2.5, label = TeX('$g(k_t)$'), size = 5, col = "red") +
  # Save
  ggsave("graph_c.png", width = 7, height = 7)

```


```{r g Function - Graph d, echo = FALSE, warning = FALSE}

df %>%
  subset(variable == "g4") %>% 
  
  ggplot(aes(x = inter, y = value)) +
  geom_line(color = red) +
  # Dashed lines (specific values)
  geom_vline(xintercept = 1, color = red, linetype = "longdash", alpha = 0.5) +
  geom_vline(xintercept = 2, color = red, linetype = "longdash", alpha = 0.5) +
  # Axis
  scale_x_continuous(name = "", breaks = c(1,2),
                     labels = c(TeX('$k_2$'),TeX('$k_1$')),
                     limits = c(0, 10), expand = c(0,0)) +
  scale_y_continuous(name = "", breaks = c(0, 7.4),
                     labels = c(TeX('$0$'), TeX('$X_t$')),
                     limits = c(-3, 7)) +
  # Graphic background
  coord_cartesian() + 
  theme_classic(base_size = 20) +
  theme(axis.line.x = element_blank(),
         axis.line = element_line(arrow = arrow(angle = 30, length = unit(0.4, "cm"), type = "open")),
         axis.ticks.x = element_blank(),
         axis.ticks.y = element_blank(),
         axis.text.x = element_text(color = red),
         axis.text.y = element_text(color = "black")) +
  annotate("segment", x = 0, xend = 9.9, y = 0, yend = 0,
           arrow = arrow(angle = 30, length = unit(0.4, "cm"), type = "open"), size = 1) +
  # Annotations
  annotate("text", x = 9.8, y = -0.4, label = TeX('$k_t$'), size = 6) +
  annotate("text", x = 4, y = 2.5, label = TeX('$g(k_t)$'), size = 5, col = "red") +
  # Save
  ggsave("graph_d.png", width = 7, height = 7)

```


